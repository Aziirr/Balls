!function(e){var t={};function l(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,l),i.l=!0,i.exports}l.m=e,l.c=t,l.d=function(e,t,s){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(l.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)l.d(s,i,function(t){return e[t]}.bind(null,i));return s},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l(l.s=0)}([function(e,t,l){"use strict";function s(){for(const e of d.allTiles)e.element.style.backgroundColor="blueviolet"}function i(e,t){if(e)for(const l of e)l.element.style.backgroundColor=t}l.r(t);class n{constructor(e,t){this.x=e,this.y=t,this.color=null,this.width=40,this.height=40,this.element=document.createElement("div"),this.walkable=!0,this.setElementPosition(),this.addOnClick(),this.addOnMouseOver()}setWalkableVariable(e){this.walkable=e}setElementPosition(){this.element.style.left=this.x*this.width+"px",this.element.style.top=this.y*this.width+"px",this.element.classList.add("tile"),document.getElementById("main").appendChild(this.element)}addOnClick(){this.element.addEventListener("click",()=>{if(d.startPoint&&this.walkable)if(d.endPoint={x:this.x,y:this.y},d.executeAStar()){d.findBallElement(d.startPoint.x,d.startPoint.y).moveBall(this.x,this.y)||(d.addNextBalls(),d.drawNewNextBallsColors())}else d.endPoint=void 0})}addOnMouseOver(){this.element.addEventListener("mouseover",()=>{d.startPoint&&this.walkable&&(d.endPoint={x:this.x,y:this.y},s(),i(d.executeAStar(),"green"))})}}class o{constructor(e,t,l){this.x=e,this.y=t,this.color=l,this.element=document.createElement("div"),this.clicked=!1,this.createElement(this.x,this.y,this.color),this.addOnClick()}setElementPosition(e,t){this.x=e,this.y=t,this.element.style.left=40*e+6+"px",this.element.style.top=40*t+6+"px"}createElement(e,t,l){this.element.style.left=40*e+6+"px",this.element.style.top=40*t+6+"px",this.element.style.backgroundColor=l,this.element.classList.add("ball"),document.getElementById("main").appendChild(this.element)}static clearCurrentBall(e){d.findBallElement(e.x,e.y).element.style.transform="scale(1)",d.clearSavedPoints()}checkIfMoveIsPossible(e,t){for(const l of d.nearbyTiles(e,t))if(l.walkable)return!0;return!1}addOnClick(){this.element.addEventListener("click",()=>{this.checkIfMoveIsPossible(this.x,this.y)&&(d.startPoint&&o.clearCurrentBall(d.startPoint),this.clicked?this.clicked=!1:(d.startPoint={x:this.x,y:this.y},this.element.style.transform="scale(1.2)",this.clicked=!0),s())})}moveBall(e,t){this.setElementPosition(e,t);let l=d.executeAStar();return i(l,"red"),setTimeout(()=>{s()},1e3),l[0].setWalkableVariable(!0),l[l.length-1].setWalkableVariable(!1),this.clicked=!1,o.clearCurrentBall({x:e,y:t}),this.checkBallsToDestroy()}checkBallsToDestroy(){if(d){const e=this.checkRow(),t=this.checkColumn(),l=this.checkFirstBias(),s=this.checkSecondBias(),i=[...new Set([...e,...t,...l,...s])];return!!(i.length>0)&&(d.destroyBalls(i),!0)}}checkRow(){let e=this.y,t=this.color,l=[];for(let s=0;s<9;s++)if(d.getBallColor(s,e)===t)l.push(d.findBallElement(s,e));else{if(l.length>=5)break;l=[]}return l.length<5&&(l=[]),l}checkColumn(){let e=this.x,t=this.color,l=[];for(let s=0;s<9;s++)if(d.getBallColor(e,s)===t)l.push(d.findBallElement(e,s));else{if(l.length>=5)break;l=[]}return l.length<5&&(l=[]),l}checkFirstBias(){let e=this.x,t=this.y;for(;e>0&&0!==t;)e--,t--;let l=this.color,s=[];for(;e<9&&t<9;){if(d.getBallColor(e,t)===l)s.push(d.findBallElement(e,t));else{if(s.length>=5)break;s=[]}e++,t++}return s.length<5&&(s=[]),s}checkSecondBias(){let e=this.x,t=this.y;for(;e>0&&8!==t;)e--,t++;let l=this.color,s=[];for(;e<9&&t>=0;){if(d.getBallColor(e,t)===l)s.push(d.findBallElement(e,t));else{if(s.length>=5)break;s=[]}e++,t--}return s.length<5&&(s=[]),s}}function a(e,t,l,s,i){const n=(n,o)=>{const a=((l,s)=>Math.abs(l-e)+10*Math.abs(s-t))(n,o),r=((e,t)=>Math.abs(e-l)+10*Math.abs(t-s))(n,o),h=a+r,d=i.find(e=>e.x===n&&e.y===o);return{x:n,y:o,element:d,gCost:a,fCost:h,hCost:r}},o=(e,t)=>!(-1===i.findIndex(l=>l.x===e&&l.y===t))&&i.find(l=>l.x===e&&l.y===t).walkable,a=(e,t)=>c.some(l=>l.x===e&&l.y===t),r=(e,t)=>d.some(l=>l.x===e&&l.y===t),h=(e,t,l)=>{if(!a(e,t-1)&&!r(e,t-1)&&o(e,t-1)){let s=n(e,t-1);s.parent=l,d.push(s)}if(!a(e-1,t)&&!r(e-1,t)&&o(e-1,t)){let s=n(e-1,t);s.parent=l,d.push(s)}if(!a(e+1,t)&&!r(e+1,t)&&o(e+1,t)){let s=n(e+1,t);s.parent=l,d.push(s)}if(!a(e,t+1)&&!r(e,t+1)&&o(e,t+1)){let s=n(e,t+1);s.parent=l,d.push(s)}d=d.sort((e,t)=>e.fCost-t.fCost)};let d=[],c=[];for(d.push(n(e,t));;){let e=d.shift();if(!e)return null;if(c.push(e),e.x===l&&e.y===s){const t=[];let l=e;for(;l;)t.unshift(l.element),l=l.parent;return t}h(e.x,e.y,e)}}class r{constructor(e,t){this.boardWidth=e,this.boardHeight=t,this.allBalls=[],this.allTiles=[],this.nextBallsColors=[],this.ballsColors=["red","blue","purple","orange","pink","black","cyan"],this.points=0,this.createBoard(this.boardHeight,this.boardWidth)}addToAllBalls(e){this.allBalls.push(e)}addToAllTiles(e){this.allTiles.push(e)}findTileElement(e,t){return this.allTiles.find(l=>l.x==e&&l.y==t)}findBallElement(e,t){return this.allBalls.find(l=>l.x==e&&l.y==t)}removeBallElement(e,t){let l=this.allBalls.findIndex(l=>l.x==e&&l.y==t);-1!==l&&this.allBalls.splice(l,1)}getBallColor(e,t){let l=this.findBallElement(e,t);return l&&l.color}drawNewNextBallsColors(){this.nextBallsColors=[];let e=document.getElementsByClassName("preview-ball");for(let t=0;t<3;t++){let l=this.ballsColors[Math.floor(Math.random()*this.ballsColors.length)];this.nextBallsColors.push(l),e[t].style.backgroundColor=l}}randomWalkablePosition(){let e,t,l=!1;for(;!l;)e=Math.floor(9*Math.random()),t=Math.floor(9*Math.random()),this.findTileElement(e,t).walkable&&(l=!0);return{x:e,y:t}}addNextBalls(){for(const e of this.nextBallsColors){let e=this.randomWalkablePosition(),t=this.ballsColors[Math.floor(Math.random()*this.ballsColors.length)];this.newBall(e.x,e.y,t),this.allBalls.length>=81&&this.gameOver()}this.drawNewNextBallsColors()}newBall(e,t,l){let s=new o(e,t,l);this.addToAllBalls(s),this.findTileElement(e,t).setWalkableVariable(!1),s.checkBallsToDestroy()}nearbyTiles(e,t){let l=[];return l.push(h.findTileElement(e-1,t)),l.push(h.findTileElement(e+1,t)),l.push(h.findTileElement(e,t-1)),l.push(h.findTileElement(e,t+1)),l=l.filter(e=>null!=e),l}executeAStar(){return a(this.startPoint.x,this.startPoint.y,this.endPoint.x,this.endPoint.y,this.allTiles)}clearSavedPoints(){this.startPoint=null,this.endPoint=null}static destroyBall(e){document.getElementById("main").removeChild(e.element),h.removeBallElement(e.x,e.y),h.findTileElement(e.x,e.y).setWalkableVariable(!0)}destroyBalls(e){for(const t of e)r.destroyBall(t);this.updatePoints(e.length)}updatePoints(e){this.points+=e,document.getElementById("points").innerText="Twoje punkty: "+this.points}gameOver(){alert("Przegrałeś, Twoja liczba punktów: "+this.points),location.reload()}createBoard(e,t){for(let l=0;l<e;l++)for(let e=0;e<t;e++){let t=new n(e,l);this.addToAllTiles(t)}this.drawNewNextBallsColors(),this.addNextBalls()}}const h=new r(9,9);var d=h}]);